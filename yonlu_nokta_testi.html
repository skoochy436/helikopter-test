<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yönlü Nokta Hatırlama Testi</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: minmax(80px, auto);
      gap: 10px;
      max-width: 800px;
      margin: 20px auto;
    }
    .card {
      border: 2px solid #000;
      padding: 10px;
      font-size: 1.5rem;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: row;
      gap: 5px;
    }
    .arrow {
      font-size: 3rem;
      margin-right: 10px;
      font-weight: bold;
    }
    .dot-area {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      width: 60px;
      height: 60px;
      gap: 2px;
    }
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: black;
      opacity: 0;
    }
    .dot.visible { opacity: 1; }
    .hidden { visibility: hidden; }
    #prompt, #question, #inputArea, #result { margin-top: 20px; font-size: 1.2rem; }
    #prompt { font-size: 2rem; height: 80px; display: flex; align-items: center; justify-content: center; }
  </style>
</head>
<body>
  <h1>Yönlü Nokta Hatırlama Testi</h1>
  <div>
    <label for="promptDuration">Prompt süresi (ms):</label>
    <input type="number" id="promptDuration" value="2000" min="0" />
    <label for="cardDuration" style="margin-left:20px;">Kart süresi (ms):</label>
    <input type="number" id="cardDuration" value="6000" min="0" />
  </div>
  <button id="startBtn">Teste Başla</button>
  <div id="prompt"></div>
  <div class="grid" id="grid"></div>
  <div id="question" style="display:none;"></div>
  <div id="inputArea" style="display:none;">
    <input type="text" id="userInput" placeholder="Örn: 3,1,2,5" />
    <button onclick="submitAnswer()">Gönder</button>
  </div>
  <div id="result"></div>
  <script>
    let promptDuration = 2000;
    let cardDuration = 6000;
    const TOTAL_ROUNDS = 10;
    let currentRound = 0, correctCount = 0;
    const directions = ['→','←','↑','↓'];
    const colors = ['blue','red'];
    let correctAnswer = [];

    function showFinalScore() {
      document.getElementById('result').textContent = `Test tamamlandı! ${correctCount}/${TOTAL_ROUNDS} doğru.`;
      document.getElementById('startBtn').disabled = false;
    }

    function startTest() {
      promptDuration = parseInt(document.getElementById('promptDuration').value,10) || 2000;
      cardDuration = parseInt(document.getElementById('cardDuration').value,10) || 6000;
      correctAnswer = [];
      currentRound++;
      document.getElementById('grid').innerHTML = '';
      const dir = directions[Math.floor(Math.random()*4)];
      const color = colors[Math.floor(Math.random()*2)];
      document.getElementById('prompt').innerHTML = `<span style="color:${color}; font-size:3rem;">${dir}</span>`;
      document.getElementById('question').textContent = `${color} ${dir} oklarındaki nokta sayılarını sırayla yaz:`;
      setTimeout(generateCards, promptDuration);
    }

    function generateCards() {
      const grid = document.getElementById('grid');
      const targetDir = document.querySelector('#prompt span').textContent;
      const targetColor = document.querySelector('#prompt span').style.color;
      while(grid.firstChild) grid.removeChild(grid.firstChild);
      const cards = [];
      for(let i=0;i<4;i++) cards.push({dir:targetDir,color:targetColor});
      while(cards.length<16) {
        const d = directions[Math.floor(Math.random()*4)];
        const c = colors[Math.floor(Math.random()*2)];
        if(d!==targetDir||c!==targetColor) cards.push({dir:d,color:c});
      }
      cards.sort(()=>Math.random()-0.5).forEach(card=>{
        const count = Math.floor(Math.random()*9)+1;
        if(card.dir===targetDir&&card.color===targetColor) correctAnswer.push(count);
        const div=document.createElement('div'); div.className='card';
        const arrow=document.createElement('div'); arrow.className='arrow'; arrow.textContent=card.dir; arrow.style.color=card.color;
        const dotArea=document.createElement('div'); dotArea.className='dot-area';
        const idx=[...Array(9).keys()].sort(()=>Math.random()-0.5);
        for(let i=0;i<9;i++){
          const d=document.createElement('div'); d.className='dot';
          if(i<count){ const pos=idx[i]; d.style.gridRowStart=Math.floor(pos/3)+1; d.style.gridColumnStart=pos%3+1;
            d.classList.add('visible');
          }
          dotArea.appendChild(d);
        }
        div.appendChild(arrow); div.appendChild(dotArea); grid.appendChild(div);
      });
      setTimeout(()=>{
        document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));
        document.getElementById('question').style.display='block';
        document.getElementById('inputArea').style.display='block';
      },cardDuration);
    }

    function submitAnswer(){
      const input=document.getElementById('userInput').value.split(',').map(x=>parseInt(x));
      const res=document.getElementById('result');
      if(JSON.stringify(input.filter(n=>!isNaN(n)))===JSON.stringify(correctAnswer)){
        res.textContent='✅ Doğru'; correctCount++;
      } else {
        res.textContent=`❌ Yanlış: ${correctAnswer.join(',')}`;
      }
      if(currentRound<TOTAL_ROUNDS){ setTimeout(()=>{res.textContent=''; document.getElementById('question').style.display='none'; document.getElementById('inputArea').style.display='none'; startTest();},1500);} else showFinalScore();
    }

    document.getElementById('startBtn').addEventListener('click',()=>{currentRound=0;correctCount=0;document.getElementById('startBtn').disabled=true;document.getElementById('question').style.display='none';document.getElementById('inputArea').style.display='none';startTest();});
  </script>
</body>
</html>
